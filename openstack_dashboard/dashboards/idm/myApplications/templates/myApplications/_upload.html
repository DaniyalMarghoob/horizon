{% extends "horizon/common/_modal_form.html" %}
{% load i18n %}
{% load url from future %}

{% block form_id %}{% endblock %}
{% block form_action %}{% url 'horizon:idm:myApplications:upload' application.id %}{% endblock %}
{% block form_enctype %}multipart/form-data{% endblock %}

{% block modal_id %}upload_image_modal{% endblock %}
{% block modal-header %}
	{% include "idm/myApplications/_step-2.html" %}
{% endblock %}

{% block modal-body %}

	{{ form.nextredir }}

	{{ form.appID }}

	<fieldset>
	<img id="avatar-update" src="{{ image }}" alt="your image"   />
		<div class="fieldWrapper" id="imgInp">
			{{ form.image }} 
			<!-- El id del input es 'id_image' -->
		</div>

		{{ form.x1 }}
		{{ form.x2 }}
		{{ form.y1 }}
		{{ form.y2 }}
		
		
	</fieldset>
<!---
	<div class="input-group">
	    <span class="input-group-btn">
	        <span class="btn btn-default btn-file">
	            Browseâ€¦ <input type='file' id="imgInp" class="new_file_avatar" accept="image/*">
	        </span>
	    </span>
	    <input type="text" class="form-control" readonly="">
	</div>

	<script>
	$(document).on('change', '.btn-file :file', function() {
	    var input = $(this),
	        numFiles = input.get(0).files ? input.get(0).files.length : 1,
	        label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
	    input.trigger('fileselect', [numFiles, label]);
	});


	$(document).ready( function() {
	    $('.btn-file :file').on('fileselect', function(event, numFiles, label) {

	        var input = $(this).parents('.input-group').find(':text'),
	            log = numFiles > 1 ? numFiles + ' files selected' : label;

	        if( input.length ) {
	            input.val(log);
	        } else {
	            if( log ) alert(log);
	        }

	    });
	});
	  
	  </script>
-->
<script>
	$('.jcrop-holder').Jcrop({
      aspectRatio: 1,  //If you want to keep aspectRatio
      boxWidth: 650,   //Maximum width you want for your bigger images
      boxHeight: 400,  //Maximum Height for your bigger images
      onSelect: updateCoords 
 },function()
 {
      alert('Now you see smaller preview of your bigger one.');
 });
</script>
{% endblock %}

{% block modal-footer %}
    <button type="submit" class="btn btn-primary">{% trans "Next" %}</button>
{% endblock %}

